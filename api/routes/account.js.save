const express = require('express');
const Router = express.Router();
const verify = require('../../middleware/verify-token');
const verifyPrivileges = require('../../middleware/verifyPrivileges');
const accountController = require('../../controller/accountController');
const client = require('redis').createClient();
const limiter = require('express-limiter')(Router,client)

limiter({
  path: '/login',
  method: 'post',
  lookup:'],
  total: 5,
  expire: 1000 * 60 * 15,
  onRateLimited: function (req, res, next) {
    next({ message: 'Rate limit exceeded', status: 429 })
  }
})

Router.post('/login',accountController.login)
Router.put('/change_password', verify.verifyToken, accountController.changePasword);
Router.put('/reset_password/:mssv', verify.verifyToken, verifyPrivileges('reset_password'), accountController.resetPassword)

module.exports = Router;
